//package com.app.empire.scene.service.warField.helper;
//
//import org.apache.commons.logging.Log;
//import org.aspectj.bridge.MessageUtil;
//
//import com.app.empire.protocol.Protocol;
//import com.app.empire.protocol.pb.army.ArmyInfoReloadMsgProto.ArmyInfoReloadMsg;
//import com.app.empire.protocol.pb.warField.PostionMsgProto.PostionMsg;
//import com.app.empire.protocol.pb.warField.Vector3Proto.PBVector3;
//import com.app.empire.scene.constant.EnterMapResult;
//import com.app.empire.scene.service.role.objects.Player;
//import com.app.empire.scene.service.warField.FieldMgr;
//import com.app.empire.scene.service.warField.field.Field;
//import com.app.empire.scene.service.world.ArmyProxy;
//import com.app.empire.scene.util.Vector3;
//import com.app.empire.scene.util.Vector3BuilderHelper;
//
///**
// * 转场处理
// * @author 
// *
// */
//public class TransportHelper {
//
//	public static void truckTransport(Truck truck, Vector3 nextVector3, int nextFieldId)
//	{
//		Field nextField = FieldMgr.getIns().getField(nextFieldId);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
//		if(nextField == null)
//		{
//			Log.error("nextFieldId = " + nextFieldId + " 未找出场景");
//			return;
//		}
//		//先镖车转场
//		truck.getField().leaveField(truck);
//		truck.setPostion(nextVector3);
//		nextField.enterField(truck);
//	}
//	
//	/**
//	 * 转场
//	 */
//	public static void transport(ArmyProxy army, Vector3 position, int fieldId)
//	{
//		Field nextField = FieldMgr.getIns().getField(fieldId);
//		if(nextField == null)
//		{
//			Log.error("fieldId = " + fieldId + " 未找出场景");
//			return;
//		}
//		// 进入前，向center服务器同步一次位置
//		reloadPos(army);
//		// 进入地图
//		int angle = 0;
//		army.changeField(nextField, position);
//		// 地图变更信息
//		ChangeMapResultMsg.Builder cmbuilder = ChangeMapResultMsg.newBuilder();
//		cmbuilder.setResult(EnterMapResult.SUCCESS);// 进入成功
//		PostionMsg.Builder postionMsg = PostionMsg.newBuilder();
//		postionMsg.setMapId(nextField.id);
//		postionMsg.setMapKey(nextField.getMapKey());
//		PBVector3.Builder builder = Vector3BuilderHelper.build(position);
//		builder.setAngle(angle);//
//		postionMsg.setPostion(builder);
//		cmbuilder.setPostion(postionMsg);
//		army.sendPbMessage(MessageUtil.buildMessage(Protocol.C_ENTER_SENCE_MAP_RESULT, cmbuilder));
//	}
//	
//	private static void reloadPos(ArmyProxy army) {
//
//		ArmyInfoReloadMsg.Builder armyReload = ArmyInfoReloadMsg.newBuilder();
//		Player player = army.getPlayer();
//		Field field = FieldMgr.getIns().getField(army.getFieldId());
//		if (field != null && player.getPostion() != null) {
//			PostionMsg.Builder postion = PostionMsg.newBuilder();
//			postion.setMapId(field.id);
//			postion.setMapKey(field.getMapKey());
//
//			Vector3 curPos = player.getPostion();
//			PBVector3.Builder pbPos = Vector3BuilderHelper.build(curPos);
//			postion.setPostion(pbPos.build());
//			armyReload.setPostion(postion.build());
//		}
//		PBMessage redata = MessageUtil.buildMessage(CenterProtocol.C_PLAYER_RELOAD_SCENCE_DATA, armyReload);
//		army.sendPbMessage(redata);
//
//	}
// }
